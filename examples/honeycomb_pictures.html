<link
  rel="stylesheet"
  href="/static/style/examples/honeycomb_pictures/index.css"
/>

<div class="honeycomb_picturess"></div>

<script>
  function createEl() {
    const el = document.createElement("div");
    el.className = "item";
    return el;
  }

  function getParentEle() {
    return document.querySelector(".honeycomb_picturess");
  }
  class Queue {
    index = 0;
    queue = [];
    constructor(queue = []) {
      this.queue = queue;
      this.parentEl = getParentEle();
      const { width } = this.parentEl.getBoundingClientRect();
      this.width = width;
    }
    runTask() {
      const currentTask = this.queue[this.index];
      if (!currentTask) return;
      currentTask(this.nextTask);
    }
    nextTask(values = []) {
      if (this.index >= this.queue.length) return;

      Promise.resolve().then(() => {
        const el = document.createDocumentFragment();
        values.forEach((_, index) => {
          const div = document.createElement("div");
          div.textContent = index.toString();
          div.style.width = `${this.width / 29}px`;
          div.style.height = `${this.width / 29}px`;
          div.classList.add("item");
          el.appendChild(div);
        });
        this.parentEl.appendChild(el);
      });
      this.index++;
      const currentTask = this.queue[this.index];
      if (!currentTask) return;
      currentTask(this.nextTask);
    }
  }
</script>

<script>
  // const row = Array.from({ length: 100 }, () => 0);
  // const col = Array.from({ length: 30 }, () => 0);

  function initTaskEl() {
    const data = Array.from({ length: 100 }, () => {
      return (next) => {
        setTimeout(() => {
          next.call(
            queue,
            Array.from({ length: 26 }, () => 0)
          );
        }, 0);
      };
    });

    var queue = new Queue(data);
    queue.runTask();
  }

  function initDelPad() {
    const parentEl = getParentEle();
    const { width } = parentEl.getBoundingClientRect();

    // for (let i = 0; i < row; i++) {
    //   for (let j = 0; j < col; j++) {
    //     const el = createEl();
    //     el.style.left = `${(width / col) * j}px`;
    //     el.style.top = `${(width / row) * i}px`;
    //     parentEl.appendChild(el);
    //   }
    // }
  }

  // 页面加载完成
  window.onload = function () {
    initTaskEl();
  };
</script>
